<!doctype html><html class=no-js lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="Wild Rydes Web Application"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.83.1"><meta name=description content="Wild Rydes Web Application"><meta name=author content="Ben Smith"><link rel="shortcut icon" href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><link rel=icon href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><title>Lambda :: Wild Rydes Web Application</title><link href=/aws-serverless-webapp-workshop/css/nucleus.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/fontawesome-all.min.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/hybrid.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/featherlight.min.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/perfect-scrollbar.min.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/auto-complete.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/theme.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/hugo-theme.css rel=stylesheet><link href=/aws-serverless-webapp-workshop/css/theme-aws.css rel=stylesheet><script src=/aws-serverless-webapp-workshop/js/jquery-3.3.1.min.js></script><script src=/aws-serverless-webapp-workshop/js/shortbreadV1.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><script>const shortbread=AWSCShortbread({domain:"webapp.serverlessworkshops.io"});shortbread.checkForCookieConsent();function showCookie(){shortbread.customizeCookies()}</script></head><body data-url=/aws-serverless-webapp-workshop/serverlessbackend/lambda/><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=/ title="Go home"><img style=vertical-align:middle src=/images/logo.png height=70px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/aws-serverless-webapp-workshop/js/lunr.min.js></script><script type=text/javascript src=/aws-serverless-webapp-workshop/js/auto-complete.js></script><script type=text/javascript>var baseurl="https://marcinbelczewski.github.io/aws-serverless-webapp-workshop/"</script><script type=text/javascript src=/aws-serverless-webapp-workshop/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/aws-serverless-webapp-workshop/setup/ title=Setup class=dd-item><a href=/aws-serverless-webapp-workshop/setup/><b>0. </b>Setup</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/setup/accountsetup/ title="Account Setup" class=dd-item><a href=/aws-serverless-webapp-workshop/setup/accountsetup/>Account Setup</a></li><li data-nav-id=/aws-serverless-webapp-workshop/setup/recap/ title=Recap class=dd-item><a href=/aws-serverless-webapp-workshop/setup/recap/>Recap</a></li></ul></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/ title="Static Web Hosting" class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/><b>1. </b>Static Web Hosting</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/overview/ title=Overview class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/overview/>Overview</a></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/region/ title=Region class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/region/>Region</a></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/repository/ title=Repository class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/repository/>Repository</a></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/deploy/ title=Deploy class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/deploy/>Deploy</a></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/modify/ title=Modify class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/modify/>Modify</a></li><li data-nav-id=/aws-serverless-webapp-workshop/staticwebhosting/recap/ title=Recap class=dd-item><a href=/aws-serverless-webapp-workshop/staticwebhosting/recap/>Recap</a></li></ul></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/ title="User Management" class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/><b>2. </b>User Management</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/overview/ title=Overview class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/overview/>Overview</a></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/amplifycli/ title="Amplify Cli" class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/amplifycli/>Amplify Cli</a></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/userpool/ title="User Pool" class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/userpool/>User Pool</a></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/appclient/ title="App Client" class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/appclient/>App Client</a></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/createuser/ title="Create a User" class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/createuser/>Create a User</a></li><li data-nav-id=/aws-serverless-webapp-workshop/usermanagement/recap/ title=Recap class=dd-item><a href=/aws-serverless-webapp-workshop/usermanagement/recap/>Recap</a></li></ul></li><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/ title="Serverless Backend" class="dd-item
parent"><a href=/aws-serverless-webapp-workshop/serverlessbackend/><b>3. </b>Serverless Backend</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/overview/ title=Overview class=dd-item><a href=/aws-serverless-webapp-workshop/serverlessbackend/overview/>Overview</a></li><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/dynamodb/ title=DynamoDB class=dd-item><a href=/aws-serverless-webapp-workshop/serverlessbackend/dynamodb/>DynamoDB</a></li><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/iam/ title=IAM class=dd-item><a href=/aws-serverless-webapp-workshop/serverlessbackend/iam/>IAM</a></li><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/lambda/ title=Lambda class="dd-item
parent
active"><a href=/aws-serverless-webapp-workshop/serverlessbackend/lambda/>Lambda</a></li><li data-nav-id=/aws-serverless-webapp-workshop/serverlessbackend/recap/ title=Recap class=dd-item><a href=/aws-serverless-webapp-workshop/serverlessbackend/recap/>Recap</a></li></ul></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/ title="RESTful APIs" class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/><b>4. </b>RESTful APIs</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/overview/ title=Overview class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/overview/>Overview</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/restapi/ title="REST API" class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/restapi/>REST API</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/cognito/ title=Cognito class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/cognito/>Cognito</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/resource/ title="API Resource" class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/resource/>API Resource</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/deploy/ title=Deploy class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/deploy/>Deploy</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/updateconfig/ title="Update Config" class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/updateconfig/>Update Config</a></li><li data-nav-id=/aws-serverless-webapp-workshop/restfulapis/recap/ title=Recap class=dd-item><a href=/aws-serverless-webapp-workshop/restfulapis/recap/>Recap</a></li></ul></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/ title=Cleanup class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/><b>9. </b>Cleanup</a><ul><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/overview/ title=Overview class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/overview/>Overview</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/module4/ title="Module 4" class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/module4/>Module 4</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/module3/ title="Module 3" class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/module3/>Module 3</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/module2/ title="Module 2" class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/module2/>Module 2</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/module1/ title="Module 1" class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/module1/>Module 1</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/cloudwatchlogs/ title="CloudWatch Logs" class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/cloudwatchlogs/>CloudWatch Logs</a></li><li data-nav-id=/aws-serverless-webapp-workshop/cleanup/cloud9/ title=Cloud9 class=dd-item><a href=/aws-serverless-webapp-workshop/cleanup/cloud9/>Cloud9</a></li></ul></li></ul><section id=footer><left><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | © 2020, Amazon Web Services, Inc. or its affiliates. All rights reserved.</left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fa fa-bars"></i></a></span>
<span id=toc-menu><i class="fa fa-list-alt"></i></span>
<span class=links><a href=https://marcinbelczewski.github.io/aws-serverless-webapp-workshop/>Wild Rydes</a> > <a href=https://marcinbelczewski.github.io/aws-serverless-webapp-workshop/serverlessbackend/>Serverless Backend</a> > Lambda</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#3-create-a-lambda-function-for-handling-requests>3. Create a Lambda Function for Handling Requests</a></li></ul></li></ul></nav></div></div></div></div><div id=body-inner><h1>Lambda</h1><h3 id=3-create-a-lambda-function-for-handling-requests>3. Create a Lambda Function for Handling Requests</h3><h4 id=background>Background</h4><p>AWS Lambda runs your code in response to events such as an HTTP request. In this step you build a function that processes API requests from the web application to dispatch a unicorn. In the next module you use Amazon API Gateway to create a RESTful API that exposes an HTTP endpoint that can be invoked from your users' browsers. Then you connect the Lambda function you create in this step to that API to create a fully functional backend for your web application.</p><h4 id=high-level-instructions>High-Level Instructions</h4><p>Use the AWS Lambda console to create a new Lambda function called <code>%INITIALS%-RequestUnicorn</code> that processes API requests. Copy and paste <a href=requestUnicorn.js>this example implementation</a> into the AWS Lambda console&rsquo;s editor for your function code.</p><p>Configure your function to use the <code>%INITIALS%-WildRydesLambda</code> IAM role you created in the previous section.</p><p><strong>✅ Step-by-step directions</strong></p><ol><li><p>Go to the <a href=https://console.aws.amazon.com/lambda/home>AWS Lambda console</a></p></li><li><p>Click <strong>Create function</strong>.</p></li><li><p>Keep the default <strong>Author from scratch</strong> card selected.</p></li><li><p>Enter <code>%INITIALS%-RequestUnicorn</code> in the <strong>Name</strong> field. <strong>⚠️</strong> Remember about your initials prefix!</p></li><li><p>Select <strong>Node.js 12.x</strong> for the <strong>Runtime</strong>.</p></li><li><p>Expand <em>Change default execution role</em> under <strong>Permissions</strong>.</p></li><li><p>Ensure <code>Use an existing role</code> is selected from the <strong>Role</strong> dropdown.</p></li><li><p>Select <code>%INITIALS%-WildRydesLambda</code> from the <strong>Existing Role</strong> dropdown.
<img src=/aws-serverless-webapp-workshop/images/create-lambda-function.png alt="Create Lambda function screenshot"></p></li><li><p>Choose <strong>Create function</strong>.</p></li><li><p>Scroll down to the <strong>Function code</strong> section and replace the existing code in the <strong>index.js</strong> code editor with the contents of <a href=requestUnicorn.js>requestUnicorn.js</a>.
<img src=/aws-serverless-webapp-workshop/images/create-lambda-function-code.png alt="Create Lambda function screenshot"></p></li><li><p><strong>⚠️ Update the code to connect to a prefixed DynamoDB table rather than default non-prefixed!</strong>. In the picture below prefix is for sample user <em>Jan Nowak</em> with <em>jn</em> as initials.
<img src=/aws-serverless-webapp-workshop/images/update-lambda-function-code.png alt="Update Lambda DynamoDB call"></p></li><li><p>Click <strong>Deploy</strong> button above the code editor.</p></li></ol><h4 id=implementation-validation>Implementation Validation</h4><p>For this module you will test the function that you built using the AWS Lambda console. In the next module you will add a REST API with API Gateway so you can invoke your function from the browser-based application that you deployed in the first module.</p><p><strong>✅ Step-by-step directions</strong></p><ol><li>From the main edit screen for your function, select <strong>Configure test events</strong> from the the <strong>Select a test event&mldr;</strong> dropdown.
<img src=/aws-serverless-webapp-workshop/images/configure-test-event.png alt="Configure test event"></li><li>Keep <strong>Create new test event</strong> selected.</li><li>Enter <code>TestRequestEvent</code> in the <strong>Event name</strong> field</li><li>Copy and paste the following test event into the editor:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON>{
    <span style=color:#f92672>&#34;path&#34;</span>: <span style=color:#e6db74>&#34;/ride&#34;</span>,
    <span style=color:#f92672>&#34;httpMethod&#34;</span>: <span style=color:#e6db74>&#34;POST&#34;</span>,
    <span style=color:#f92672>&#34;headers&#34;</span>: {
        <span style=color:#f92672>&#34;Accept&#34;</span>: <span style=color:#e6db74>&#34;*/*&#34;</span>,
        <span style=color:#f92672>&#34;Authorization&#34;</span>: <span style=color:#e6db74>&#34;eyJraWQiOiJLTzRVMWZs&#34;</span>,
        <span style=color:#f92672>&#34;content-type&#34;</span>: <span style=color:#e6db74>&#34;application/json; charset=UTF-8&#34;</span>
    },
    <span style=color:#f92672>&#34;queryStringParameters&#34;</span>: <span style=color:#66d9ef>null</span>,
    <span style=color:#f92672>&#34;pathParameters&#34;</span>: <span style=color:#66d9ef>null</span>,
    <span style=color:#f92672>&#34;requestContext&#34;</span>: {
        <span style=color:#f92672>&#34;authorizer&#34;</span>: {
            <span style=color:#f92672>&#34;claims&#34;</span>: {
                <span style=color:#f92672>&#34;cognito:username&#34;</span>: <span style=color:#e6db74>&#34;the_username&#34;</span>
            }
        }
    },
    <span style=color:#f92672>&#34;body&#34;</span>: <span style=color:#e6db74>&#34;{\&#34;PickupLocation\&#34;:{\&#34;Latitude\&#34;:47.6174755835663,\&#34;Longitude\&#34;:-122.28837066650185}}&#34;</span>
}
</code></pre></div><p><img src=/aws-serverless-webapp-workshop/images/configure-test-event-2.png alt="Configure test event"></p></li><li>Choose <strong>Create</strong>.</li><li>On the main function edit screen click <strong>Test</strong> with <code>TestRequestEvent</code> selected in the dropdown.</li><li>Scroll to the top of the page and expand the <strong>Details</strong> section of the <strong>Execution result</strong> section.</li><li>Verify that the execution succeeded and that the function result looks like the following:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON>{
  <span style=color:#f92672>&#34;statusCode&#34;</span>: <span style=color:#ae81ff>201</span>,
  <span style=color:#f92672>&#34;body&#34;</span>: <span style=color:#e6db74>&#34;{\&#34;RideId\&#34;:\&#34;1h0zDZ-6KLZaEQCPyqTxeQ\&#34;,\&#34;Unicorn\&#34;:{\&#34;Name\&#34;:\&#34;Shadowfax\&#34;,\&#34;Color\&#34;:\&#34;White\&#34;,\&#34;Gender\&#34;:\&#34;Male\&#34;},\&#34;UnicornName\&#34;:\&#34;Shadowfax\&#34;,\&#34;Eta\&#34;:\&#34;30 seconds\&#34;,\&#34;Rider\&#34;:\&#34;the_username\&#34;}&#34;</span>,
  <span style=color:#f92672>&#34;headers&#34;</span>: {
    <span style=color:#f92672>&#34;Access-Control-Allow-Origin&#34;</span>: <span style=color:#e6db74>&#34;*&#34;</span>
  }
}
</code></pre></div></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/aws-serverless-webapp-workshop/serverlessbackend/iam/ title=IAM><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/aws-serverless-webapp-workshop/serverlessbackend/recap/ title=Recap style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/aws-serverless-webapp-workshop/js/clipboard.min.js></script><script src=/aws-serverless-webapp-workshop/js/perfect-scrollbar.min.js></script><script src=/aws-serverless-webapp-workshop/js/perfect-scrollbar.jquery.min.js></script><script src=/aws-serverless-webapp-workshop/js/jquery.sticky.js></script><script src=/aws-serverless-webapp-workshop/js/featherlight.min.js></script><script src=/aws-serverless-webapp-workshop/js/html5shiv-printshiv.min.js></script><script src=/aws-serverless-webapp-workshop/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script src=/aws-serverless-webapp-workshop/js/modernizr.custom-3.6.0.js></script><script src=/aws-serverless-webapp-workshop/js/learn.js></script><script src=/aws-serverless-webapp-workshop/js/hugo-learn.js></script><link href=/aws-serverless-webapp-workshop/mermaid/mermaid.css rel=stylesheet><script src=/aws-serverless-webapp-workshop/mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:!0})</script><section style=text-align:center><p class=site-footer__copy><a href=https://aws.amazon.com/privacy/>Privacy</a> |
<a href=https://aws.amazon.com/terms/>Site Terms</a> |
<a href=# onclick=showCookie()>Cookie Preferences</a> |
&copy; Copyright 2020 Amazon.com, Inc. or its affiliates. All rights reserved.</p></section></body></html>